$(document).ready(function(){!function(o){function t(){var t=o(window).height(),n=o(document).scrollTop(),a=n/(s-t),r=a*(e-t);if(a>1){var l=e-t,f=s-n;o(".overlay").css({position:"fixed",top:-l+f-i})}else o(".overlay").css({position:"fixed",top:-r})}o.fn.closestToOffset=function(t){var i,e,n,s,a,r=null,l=t.left,f=t.top;return this.each(function(){if(i=o(this).offset(),l>=i.left&&l<=i.right&&f>=i.top&&f<=i.bottom)return r=o(this),!1;var t=[[i.left,i.top],[i.right,i.top],[i.left,i.bottom],[i.right,i.bottom]];for(off in t)n=t[off][0]-l,s=t[off][1]-f,e=Math.sqrt(n*n+s*s),(void 0===a||a>e)&&(a=e,r=o(this))}),r},o.fn.positionPoints=function(){n=o(this),o(".point").each(function(){$point=o(this),$point.addClass("visible");var t=$point.width(),i=$point.data("x")/100*(n.width()-t/2),e=$point.data("y")/100*(n.height()-t/2);$point.css({top:e,left:i})})};var i,e,n,s;o(window).scroll(function(){t()}),o(window).load(function(){function a(){var t=o(document).scrollTop(),i=o(document).height()-o(window).height();t>=i-40?o("html, body").stop().animate({scrollTop:0},1500):o(".scrollTo").each(function(){var i=o(this).position().top-t;if(i>100){var e=i+t;return o(this).hasClass("clearfix")&&(e=i+t-80),o("html, body").stop().animate({scrollTop:e},400),!1}})}n=o(".overlay"),o(window).resize(function(){i=o("footer").outerHeight(),e=n.height(),s=o(document).height()-i,n.positionPoints(),t()}).resize(),o(".point").hover(function(){$point=o(this);var t=o(".overlay").offset(),i=$point.offset().left+$point.width()/2,n=$point.offset().top+$point.height()/2-t.top,s=i/o(window).width()*100,a=n/e*100;o(".overlay-image").css({"transform-origin":s+"% "+a+"%","-ms-transform-origin":s+"% "+a+"%","-moz-transform-origin":s+"% "+a+"%","-o-transform-origin":s+"% "+a+"%","-webkit-transform-origin":s+"% "+a+"%"}),o(".overlay, .caption").addClass("visible"),o(".caption").html($point.data("title"))},function(){o(".overlay-image").removeClass("zoom"),o(".overlay, .caption").removeClass("visible")}),o(".point").click(function(){o(".overlay-image").hasClass("zoom")?(o(".overlay-image").removeClass("zoom"),o(".overlay, .caption").removeClass("visible")):o(".overlay-image").addClass("zoom")}),o('a[href^="#"]').click(function(t){if(t.preventDefault(),o(this).hasClass("cv")){o("body").addClass("hide");var i=o(this).attr("href");o(i).addClass("active")}else{var e=o(this).attr("href");o("html, body").animate({scrollTop:o(e).offset().top},400)}}),o(document).keydown(function(t){switch(t.which){case 38:case 33:prevSection();break;case 40:case 34:a();break;case 36:o("body, html").stop().animate({scrollTop:0},400);break;case 35:o("body, html").stop().animate({scrollTop:o(document).height()-o(window).height()},400);break;default:return}t.preventDefault()}),setTimeout(function(){o(window).mousemove(function(t){var i=t.pageX,e=t.pageY,n=o(".point").closestToOffset({left:i,top:e});o(".point").removeClass("highlight visible"),n.addClass("highlight")})},1500)})}(jQuery)});