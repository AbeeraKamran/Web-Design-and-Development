!function(o){function i(){var i=o(window).height(),n=o(document).scrollTop(),s=n/(a-i),r=s*(e-i);if(s>1){var l=e-i,c=a-n;o(".overlay").css({position:"fixed",top:-l+c-t})}else o(".overlay").css({position:"fixed",top:-r})}o.fn.positionPoints=function(){n=o(this),o(".point").each(function(){$point=o(this),$point.addClass("visible");var i=$point.width(),t=$point.data("x")/100*(n.width()-i/2),e=$point.data("y")/100*(n.height()-i/2);$point.css({top:e,left:t})})};var t,e,n,a;o(window).scroll(function(){i()}),o(window).load(function(){function s(){var i=o(document).scrollTop(),t=o(document).height()-o(window).height();i>=t-40?o("html, body").stop().animate({scrollTop:0},1500):o(".scrollTo").each(function(){var t=o(this).position().top-i;if(t>100){var e=t+i;return o(this).hasClass("clearfix")&&(e=t+i-80),o("html, body").stop().animate({scrollTop:e},400),!1}})}n=o(".overlay"),o(window).resize(function(){t=o(".map-wrap").outerHeight(),e=n.height(),a=o(document).height()-t,n.positionPoints(),i()}).resize(),o(".point").hover(function(){$point=o(this);var i=o(".overlay").offset(),t=$point.offset().left+$point.width()/2,n=$point.offset().top+$point.height()/2-i.top,a=t/o(window).width()*100,s=n/e*100;o(".overlay-image").css({"transform-origin":a+"% "+s+"%","-ms-transform-origin":a+"% "+s+"%","-moz-transform-origin":a+"% "+s+"%","-o-transform-origin":a+"% "+s+"%","-webkit-transform-origin":a+"% "+s+"%"}),o(".overlay, .caption").addClass("visible"),o(".caption").html($point.data("title"))},function(){o(".overlay-image").removeClass("zoom"),o(".overlay, .caption").removeClass("visible")}),o(".point").click(function(){o(".overlay-image").hasClass("zoom")?(o(".overlay-image").removeClass("zoom"),o(".overlay, .caption").removeClass("visible")):o(".overlay-image").addClass("zoom")}),o(document).keydown(function(i){switch(i.which){case 38:case 33:prevSection();break;case 40:case 34:s();break;case 36:o("body, html").stop().animate({scrollTop:0},400);break;case 35:o("body, html").stop().animate({scrollTop:o(document).height()-o(window).height()},400);break;default:return}i.preventDefault()})})}(jQuery);